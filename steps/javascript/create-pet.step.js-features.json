{
  "stepName": "JsCreatePet",
  "stepType": "api",
  "description": "Creates a new pet in the system with real-time streaming updates using Motia's native Streams API",
  "endpoint": {
    "method": "POST",
    "path": "/js/pets",
    "description": "Creates a new pet with basic information and returns stream result for real-time updates"
  },
  "features": [
    {
      "title": "Pet Creation",
      "description": "Creates a new pet record with validated input data including name, species, age, and optional weight and symptoms",
      "details": [
        "Validates required fields: name (string), species (dog/cat/bird/other), ageMonths (number)",
        "Accepts optional fields: weightKg (number), symptoms (array)",
        "Generates unique pet ID and sets initial status to 'new'",
        "Stores pet data in JavaScript store"
      ]
    },
    {
      "title": "Event Emission",
      "description": "Emits workflow events to trigger downstream processing",
      "details": [
        "Emits 'js.pet.created' event with pet creation data",
        "Emits 'js.feeding.reminder.enqueued' event to trigger feeding reminder setup",
        "Events contain petId, name, species, and traceId information"
      ]
    },
    {
      "title": "Input Validation",
      "description": "Comprehensive validation of incoming pet data",
      "details": [
        "Validates name is non-empty string",
        "Validates species is one of: dog, cat, bird, other",
        "Validates ageMonths is a finite number",
        "Returns 400 error with descriptive message for invalid data",
        "Handles optional weightKg and symptoms fields gracefully"
      ]
    },
    {
      "title": "Motia Native Streaming",
      "description": "Uses Motia's native Streams API for real-time updates",
      "details": [
        "Creates initial stream record with pet creation message",
        "Returns stream result object directly (required for Motia streaming)",
        "Stream includes pet details embedded in message",
        "Enables real-time updates from downstream steps",
        "Follows Motia's streaming pattern for proper integration"
      ]
    },
    {
      "title": "Logging",
      "description": "Structured logging for monitoring and debugging",
      "details": [
        "Logs pet creation with key details (petId, name, species, status)",
        "Uses emoji prefix for easy log identification",
        "Includes structured data for log analysis"
      ]
    }
  ],
  "workflowIntegration": {
    "triggers": ["External API calls"],
    "emits": [
      {
        "topic": "js.pet.created",
        "description": "Triggers AI profile enrichment and lifecycle orchestration"
      },
      {
        "topic": "js.feeding.reminder.enqueued", 
        "description": "Triggers background job to set up feeding reminders and status updates"
      }
    ],
    "flow": "JsPetManagement"
  },
  "inputSchema": {
    "required": ["name", "species", "ageMonths"],
    "optional": ["weightKg", "symptoms"],
    "validation": {
      "name": "Non-empty string",
      "species": "One of: dog, cat, bird, other",
      "ageMonths": "Finite number",
      "weightKg": "Number (optional)",
      "symptoms": "Array of strings (optional)"
    }
  },
  "outputSchema": {
    "success": {
      "status": 201,
      "body": {
        "id": "Stream ID for tracking updates",
        "groupId": "Trace ID for workflow correlation",
        "message": "Initial pet creation message with pet details"
      }
    },
    "error": {
      "status": 400,
      "body": "Error message with validation details"
    }
  },
  "streamingFeatures": [
    {
      "type": "message",
      "description": "Real-time status updates via Motia Streams API",
      "details": [
        "Initial creation message with pet details",
        "Quarantine status updates from feeding reminder job",
        "Health check results based on symptoms",
        "Final status determination (healthy/ill/available)"
      ]
    }
  ]
}


